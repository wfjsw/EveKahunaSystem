
<div align="center">

# ğŸŒŸ Kahuna Bot ğŸŒŸ

![Logo](https://github.com/user-attachments/assets/40c09a45-f898-4167-9315-20df6a1dc59a)

[![å¼€å‘çŠ¶æ€](https://img.shields.io/badge/çŠ¶æ€-å¼€å‘ä¸­-yellow)](https://github.com/AraragiEro/astrbot_plugin_kahunabot)
[![EVE Online](https://img.shields.io/badge/æ¸¸æˆ-EVE%20Online-blue)](https://www.eveonline.com/)
[![AstrBot](https://img.shields.io/badge/æ¡†æ¶-AstrBot-green)](https://github.com/AstrBotDevs/AstrBot.git)

_ç¬¨ç¬¨çš„kahunaä¸åœçš„è®¡ç®—è‡ªå·±ç¦»ä¹°ç‰›è§’åŒ…è¿˜æœ‰å¤šè¿œ_

_ä¸€åº§æ–°çš„**X**å±±æ‹”åœ°è€Œèµ·ï¼_

ğŸ¥° _çˆ±æ¥è‡ª å‡›å†¬è”ç›Ÿç¾¤ ç´«ç«¹æ¢…é‡å·¥_

![sty](https://github.com/user-attachments/assets/f37a6a06-b925-4836-8561-282720f06506)

</div>

## ğŸ“ é¡¹ç›®ç®€ä»‹

æœ¬æ’ä»¶æ˜¯åŸºäºAstrBotæ¡†æ¶çš„EVE Onlineæ¸¸æˆè¾…åŠ©æœºå™¨äººï¼Œä¸ºç©å®¶æä¾›å¸‚åœºä»·æ ¼æŸ¥è¯¢ã€æˆæœ¬è®¡ç®—ã€å·¥ä¸šè§„åˆ’ç­‰åŠŸèƒ½ã€‚

> âš ï¸ æœ¬æ’ä»¶å¤„äºæ—©æœŸå¼€å‘é˜¶æ®µï¼Œè¿˜æœ‰å¥½å¤šå¥½å¤šçš„bug~
> 
> æ¬¢è¿æissue~

## ğŸ“‹ ç›®å½•

- [ğŸŒŸ Kahuna Bot ğŸŒŸ](#-kahuna-bot-)
  - [ğŸ“ é¡¹ç›®ç®€ä»‹](#-é¡¹ç›®ç®€ä»‹)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [â­ åŠŸèƒ½å±•ç¤º](#-åŠŸèƒ½å±•ç¤º)
    - [å‰ä»–å’Œè”ç›Ÿå¸‚åœºä»·æ ¼æŸ¥è¯¢](#å‰ä»–å’Œè”ç›Ÿå¸‚åœºä»·æ ¼æŸ¥è¯¢)
    - [æˆæœ¬æŸ¥è¯¢](#æˆæœ¬æŸ¥è¯¢)
    - [å·¥ä¸šè§„åˆ’ä¸æŠ¥è¡¨è¾“å‡º](#å·¥ä¸šè§„åˆ’ä¸æŠ¥è¡¨è¾“å‡º)
    - [åŒ–çŸ¿åˆ†æ](#åŒ–çŸ¿åˆ†æ)
    - [å¯è‡ªå®šä¹‰æ•°æ®æ¥æºçš„é‡‡è´­æ¸…å•](#å¯è‡ªå®šä¹‰æ•°æ®æ¥æºçš„é‡‡è´­æ¸…å•)
    - [åˆ©æ¶¦åˆ†æ](#åˆ©æ¶¦åˆ†æ)
    - [æŒ‚å•åˆ†æ](#æŒ‚å•åˆ†æ)
    - [èµ„äº§ç»Ÿè®¡](#èµ„äº§ç»Ÿè®¡)
  - [ğŸ˜‡ å¦‚ä½•éƒ¨ç½²ï¼Ÿ](#-å¦‚ä½•éƒ¨ç½²)
    - [éƒ¨ç½²AstrBot](#éƒ¨ç½²astrbot)
    - [ä¸‹è½½æ’ä»¶](#ä¸‹è½½æ’ä»¶)
    - [é…ç½®æ’ä»¶](#é…ç½®æ’ä»¶)
      - [å®‰è£…ä¾èµ–](#å®‰è£…ä¾èµ–)
      - [å‡†å¤‡SDEæ•°æ®åº“](#å‡†å¤‡sdeæ•°æ®åº“)
      - [é£ä¹¦APIè·å–](#é£ä¹¦apiè·å–)
      - [ä¿®æ”¹é…ç½®æ–‡ä»¶](#ä¿®æ”¹é…ç½®æ–‡ä»¶)
  - [å…³äºå·¥ä¸šè§„åˆ’å¦‚ä½•ä½¿ç”¨çš„ä¸€ä»½ç²—ç•¥çš„è¯´æ˜ï¼Œå…ˆå‡‘åˆç”¨](#å…³äºå·¥ä¸šè§„åˆ’å¦‚ä½•ä½¿ç”¨çš„ä¸€ä»½ç²—ç•¥çš„è¯´æ˜å…ˆå‡‘åˆç”¨)
  - [ğŸŒŸ æ”¯æŒä¸€ä¸‹](#-æ”¯æŒä¸€ä¸‹)

---

## â­ åŠŸèƒ½å±•ç¤º

### å‰ä»–å’Œè”ç›Ÿå¸‚åœºä»·æ ¼æŸ¥è¯¢
![å‰ä»–å’Œè”ç›Ÿå¸‚åœºä»·æ ¼æŸ¥è¯¢](https://github.com/user-attachments/assets/fc70e5ea-51af-41b2-b947-93ccfa6aa908)

### æˆæœ¬æŸ¥è¯¢
![æˆæœ¬æŸ¥è¯¢](https://github.com/user-attachments/assets/924da9e1-335d-422f-b2b3-2fbb441b6915)

### å·¥ä¸šè§„åˆ’ä¸æŠ¥è¡¨è¾“å‡º
![å·¥ä¸šè§„åˆ’](https://github.com/user-attachments/assets/f23b7873-dbb3-48df-9ee9-4d07ed4dba21)

![æŠ¥è¡¨è¾“å‡º1](https://github.com/user-attachments/assets/9d2f4b57-04a4-4f31-909e-fbb72e86e4fb)

![æŠ¥è¡¨è¾“å‡º2](https://github.com/user-attachments/assets/235c724e-f465-4966-98b8-0dc4cf7acc50)

### åŒ–çŸ¿åˆ†æ
<img src="https://github.com/user-attachments/assets/8a1f865f-ec7a-416d-9640-fd87f3e46b55" height=1200>

### å¯è‡ªå®šä¹‰æ•°æ®æ¥æºçš„é‡‡è´­æ¸…å•
<img src="https://github.com/user-attachments/assets/25b891e5-8bb8-4d77-b55a-f6e1c6e2d389" height=800>

### åˆ©æ¶¦åˆ†æ
<img src="https://github.com/user-attachments/assets/514b9bbc-20b6-4e13-a7a5-dfb8e5db43ef" height=1200>

### æŒ‚å•åˆ†æ
<img src="https://github.com/user-attachments/assets/1e05f586-66b5-4495-a431-e6b8770131c5" height=800>

### èµ„äº§ç»Ÿè®¡
<img src="https://github.com/user-attachments/assets/aa6a15b5-6902-4e38-9ec7-bfb09566de89" height=800>


ğŸ‘‰ æŠ¥è¡¨å†…å®¹ä¸°å¯Œï¼ŒåŒ…æ‹¬ä»»åŠ¡åˆ†è§£ï¼Œææ–™é‡‡è´­ï¼Œç‰©æµæ¸…å•ï¼Œå·¥ä½œä»»åŠ¡ç­‰ï¼Œä¸€ç«™å¼è§£æ”¾å·¥ä¸šåˆ¶é€ çš„è„‘åŠ›æ¶ˆè€—ï¼ŒğŸ«¡å…¬å¸çº§åˆ«æä¾›æ™ºèƒ½è®¡ç®—æœåŠ¡ã€‚

---

## ğŸ˜‡ å¦‚ä½•éƒ¨ç½²ï¼Ÿ

### éƒ¨ç½²AstrBot

æœ¬é¡¹ç›®æ˜¯AstrBotæ¡†æ¶é¢å‘QQçš„æœºå™¨äººæ’ä»¶ï¼Œä½ éœ€è¦å…ˆéƒ¨ç½²åŸºäºAstrBotçš„QQæœºå™¨äººã€‚

ğŸ‘‰ å‰å¾€ [AstrBotå®˜æ–¹ä»“åº“](https://github.com/AstrBotDevs/AstrBot.git) è·å–è¯¦ç»†éƒ¨ç½²æŒ‡å—ã€‚

### ä¸‹è½½æ’ä»¶

æ’ä»¶æš‚æ—¶æ²¡æœ‰ä¸Šæ¶æ’ä»¶å•†åœºï¼Œéœ€è¦æ‰‹åŠ¨éƒ¨ç½²ã€‚

é¦–å…ˆå‰å¾€pluginç›®å½•ï¼š
```
AstrBot/
â”œâ”€â”€ [å…¶ä»–æ–‡ä»¶]/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ [å…¶ä»–æ–‡ä»¶]/
â”‚   â”œâ”€â”€ plugins/              # æ’ä»¶ç›®å½•
```

å°†é¡¹ç›®cloneåˆ°pluginæ–‡ä»¶å¤¹ä¸‹ï¼š
```bash
git clone https://github.com/AraragiEro/astrbot_plugin_kahunabot.git
```

kahunabotçš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
kahunabot/
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ event/              # äº‹ä»¶å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ permission_checker/ # æƒé™æ£€æŸ¥æ¨¡å—
â”‚   â”œâ”€â”€ resource/           # èµ„æºæ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ css/           # æ ·å¼æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ img/           # å›¾ç‰‡èµ„æº
â”‚   â”‚   â””â”€â”€ templates/     # æ¨¡æ¿æ–‡ä»¶
â”‚   â”œâ”€â”€ rule_checker/      # è§„åˆ™æ£€æŸ¥æ¨¡å—[åºŸå¼ƒ]
â”‚   â”œâ”€â”€ service/           # æœåŠ¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ asset_server/  # èµ„äº§æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ character_server/  # è§’è‰²ç®¡ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ config_server/  # é…ç½®ç®¡ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ database_server/  # æ•°æ®åº“æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ eveeso_server/  # eve apiç®¡ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ feishu_server/  # é£ä¹¦apiç®¡ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ google_server/  # è°·æ­Œè¡¨æ ¼apiç®¡ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ industry_server/  # å·¥ä¸šè®¡ç®—æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ log_server/  # æ—¥å¿—æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ market_server/ # å¸‚åœºæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ sde_service/   # SDEæ•°æ®æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ picture_render_service/   # htmlç”Ÿå›¾æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ resource/   # é™æ€èµ„æº
â”‚   â”‚   â””â”€â”€ user_server/   # ç”¨æˆ·ç®¡ç†æ¨¡å—
â”‚   â””â”€â”€ utils/             # å·¥å…·æ¨¡å—
â”œâ”€â”€ data/                   # æ•°æ®åº“å­˜æ”¾ç›®å½•ï¼Œå¯é€‰ç”¨
â”œâ”€â”€ config.toml.example    # é…ç½®æ–‡ä»¶æ¨¡æ¿ (TOML æ ¼å¼)
â”œâ”€â”€ config.ini.example     # é…ç½®æ–‡ä»¶æ¨¡æ¿ (INI æ ¼å¼ï¼Œå·²å¼ƒç”¨ï¼Œå»ºè®®ä½¿ç”¨ TOML)
â”œâ”€â”€ main.py                # æ’ä»¶å…¥å£
â”œâ”€â”€ filter.py              # æƒé™è¿‡æ»¤å™¨
â””â”€â”€ requirements.txt       # ä¾èµ–åŒ…åˆ—è¡¨
```

### é…ç½®æ’ä»¶

#### å®‰è£…ä¾èµ–

1. å®‰è£…pyppeteer
```bash
# ä¸‹è½½é€Ÿåº¦æ…¢å¯ä»¥è€ƒè™‘ä½¿ç”¨åŠ é€Ÿæº
pip install pyppeteer -i https://pypi.tuna.tsinghua.edu.cn/simple
```

2. å®‰è£…æµè§ˆå™¨ä¾èµ–
```bash
pyppeteer-install

apt-get install -y libglib2.0-0 libnss3 libatk1.0-0 libatk-bridge2.0-0 libcups2 libdrm2 libxkbcommon0 libxcomposite1 libxdamage1 libxfixes3 libxrandr2 libgbm1 libasound2 libpango-1.0-0 libpangocairo-1.0-0 libcairo2 libatspi2.0-0
apt-get install -y fonts-noto-cjk fonts-noto-cjk-extra fonts-arphic-ukai fonts-arphic-uming

# å¦‚æœç”Ÿæˆçš„å›¾ç‰‡ä¸­æ–‡éƒ½æ˜¯æ–¹æ¡†ï¼Œéœ€è¦è¡¥å……å®‰è£…ä¸­æ–‡å­—ä½“

```

#### å‡†å¤‡SDEæ•°æ®åº“

- SDEæ•°æ®åº“ç”Ÿæˆå·¥å…·ï¼š**[EVE-SDE-Database-Builder](https://github.com/EVEIPH/EVE-SDE-Database-Builder.git)**
- å®˜æ–¹SDEæ•°æ®åº“æ›´æ–°åœ°å€ï¼š**[https://developers.eveonline.com/](https://developers.eveonline.com/)**

ä½¿ç”¨æ•°æ®åº“ç”Ÿæˆå·¥å…·å¤„ç†CCPå®˜æ–¹å‘å¸ƒçš„SDEæ•°æ®åº“ï¼Œè¾“å‡ºè‹±æ–‡å’Œä¸­æ–‡çš„SQLiteç‰ˆæœ¬æ•°æ®åº“å¤‡ç”¨ã€‚

ğŸ‘‡ å‚è€ƒä¸‹å›¾ ğŸ‘‡

![SDEæ•°æ®åº“ç”Ÿæˆ](https://github.com/user-attachments/assets/8db7c904-dbd7-4497-a0ad-efdc6358c58b)

#### é£ä¹¦APIè·å–

1. å‰å¾€ **[é£ä¹¦å¼€å‘å¹³å°](https://open.feishu.cn/app)** æ³¨å†Œè´¦å·ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªåº”ç”¨è·å–AppIDå’ŒSecretID

   ![é£ä¹¦å¼€å‘å¹³å°](https://github.com/user-attachments/assets/3e321503-edaa-48f8-b964-5a2d39712a73)

   ![è·å–AppIDå’ŒSecretID](https://github.com/user-attachments/assets/820341a3-c37d-42af-a67b-b05c0eed8706)

2. æ·»åŠ æœºå™¨äººåº”ç”¨

   ![æ·»åŠ æœºå™¨äººåº”ç”¨](https://github.com/user-attachments/assets/310e6f16-93a1-45fc-b5d4-6d65b85814ba)

3. å¼€é€šåº”ç”¨æƒé™ï¼Œå…¨é€‰äº‘æ–‡æ¡£æƒé™å³å¯

   ![å¼€é€šåº”ç”¨æƒé™](https://github.com/user-attachments/assets/e83653ed-3e72-4264-94a7-77ca751109fd)

4. ç»™æœºå™¨äººæ·»åŠ äº‘æ–‡æ¡£æƒé™ [å¦‚ä½•ä¸ºåº”ç”¨å¼€é€šäº‘æ–‡æ¡£ç›¸å…³èµ„æºçš„æƒé™](https://open.feishu.cn/document/uAjLw4CM/ugTN1YjL4UTN24CO1UjN/trouble-shooting/how-to-add-permissions-to-app)

5. æ–°å»ºä¸€ä¸ªäº‘æ–‡æ¡£æ–‡ä»¶å¤¹å¹¶è·å–é“¾æ¥ï¼Œå½¢å¼ä¸º`https://bcnzl0ndjqqq.feishu.cn/drive/folder/{folder_id}`ï¼Œå°†folder_idè®°å½•

#### ä¿®æ”¹é…ç½®æ–‡ä»¶

**æ¨èä½¿ç”¨ TOML æ ¼å¼ï¼ˆæ–°ï¼‰**ï¼š
å°†`config.toml.example`å¤åˆ¶ä¸€ä»½ï¼Œé‡å‘½åä¸º`config.toml`ï¼Œç„¶åå¡«å†™ç›¸åº”çš„é…ç½®å€¼ã€‚

**å…¼å®¹ INI æ ¼å¼ï¼ˆæ—§ï¼‰**ï¼š
å¦‚æœ `config.toml` ä¸å­˜åœ¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°è¯•è¯»å– `config.ini`ã€‚å°†`config.ini.example`å¤åˆ¶ä¸€ä»½ï¼Œé‡å‘½åä¸º`config.ini`ã€‚

> **æ³¨æ„**ï¼šTOML æ ¼å¼æ”¯æŒæ›´å¥½çš„æ³¨é‡Šå’Œç±»å‹å®‰å…¨ï¼Œå»ºè®®æ–°é¡¹ç›®ä½¿ç”¨ TOML æ ¼å¼ã€‚é…ç½®æ–‡ä»¶ä¼šè‡ªåŠ¨å‘åå…¼å®¹ï¼Œå¦‚æœ `config.toml` ä¸å­˜åœ¨ï¼Œä¼šå›é€€åˆ° `config.ini`ã€‚

```ini
[APP]
DBTYPE = sqlite # æ•°æ®åº“ç±»å‹ï¼Œæš‚æ—¶åªæ”¯æŒsqliteã€‚æœ¬åœ°æ•°æ®åº“è®°å¾—å¤šå¤‡ä»½å“¦~
COST_PLAN_USER = # å…¬å…±æˆæœ¬è®¡ç®—æ¥å£åŸºå‡†è§’è‰²
COST_PLAN_NAME = # å…¬å…±æˆæœ¬è®¡ç®—æ¥å£åŸºå‡†è§’è‰²åç§°
CORP_ASSET_USER =   # 
PIC_RENDER_PROXY =  # å›¾ç‰‡æ¸²æŸ“ä»£ç†åœ°å€ï¼Œé»˜è®¤ä¸ºç©ºï¼Œä¸ä½¿ç”¨ä»£ç†

[FEISHU]
APP_ID = MyApp      # é£ä¹¦è¡¨æ ¼è¾“å‡ºç›¸å…³é…ç½®
SECRET_ID = 1.0     
FOLDER_ROOT = xxx   # å¡«å…¥åˆšæ‰è·å–çš„folder_id

[POSTGREDB]     # æš‚æœªå¯ç”¨
Host = localhost
Port = 5432
User = admin
Password = secret

[SQLITEDB] # æ•°æ®åº“è·¯å¾„ï¼Œå¡«å†™ç»å¯¹è·¯å¾„
CONFIG_DB = F:\path\to\kahuna.db
CACHE_DB = F:\path\to\cache.db
SDEDB = F:\path\to\sde.db           # åˆšæ‰è·å–çš„è‹±æ–‡sdeæ•°æ®åº“
CN_SDEDB = F:\path\to\sde_cn.db     # åˆšæ‰è·å–çš„ä¸­æ–‡sdeæ•°æ®åº“

[EVE]   # eveç›¸å…³é…ç½®ï¼Œåœ¨https://developers.eveonline.com/ç”³è¯·åº”ç”¨è·å–
CLIENT_ID =
SECRET_KEY =
MARKET_AC_CHARACTER_ID=     # ç©å®¶å»ºç­‘å¸‚åœºè®¿é—®è§’è‰²idï¼Œå…ˆç½®ç©º

[ESI]   # esiæƒé™é…ç½®ï¼Œéœ€è¦å’Œç”³è¯·çš„åº”ç”¨ä¿æŒä¸€è‡´ï¼Œé»˜è®¤å…¨éƒ¨ä¸ºtrueï¼Œæ„ä¸ºå…¨éƒ¨æƒé™ï¼Œéœ€è¦å…³é—­çš„æƒé™æ”¹ä¸ºfalseã€‚
publicData = true
esi-calendar.respond_calendar_events.v1 = true
esi-calendar.read_calendar_events.v1 = true
esi-location.read_location.v1 = true
esi-location.read_ship_type.v1 = true
esi-mail.organize_mail.v1 = true
......
```

## å…³äºå·¥ä¸šè§„åˆ’å¦‚ä½•ä½¿ç”¨çš„ä¸€ä»½ç²—ç•¥çš„è¯´æ˜ï¼Œå…ˆå‡‘åˆç”¨

ğŸ‘‰ [å°å¡botåˆçº§ä½¿ç”¨æŒ‡å—](https://conscious-cord-0d1.notion.site/bot-1920b0a9ac1b80998d71c4349b241145)

## TODO LIST
 - [x] QQbotå¼€å‘
 - [ ] ç½‘ç«™å¼€å‘
   - [ ] å‰ç«¯å¼€å‘
     - [ ] æ¡†æ¶
   - [x] esiè®¿é—®é˜Ÿåˆ—æ§åˆ¶
   - [ ] æ•°æ®åº“é‡æ„
     - [x] éƒ¨ç½²postgreå’Œredis

## ğŸŒŸ æ”¯æŒä¸€ä¸‹
æ±‚ä¸ªstarã€‚
è§‰å¾—å¥½ç”¨çš„è¯ï¼Œç»™å­©å­æ‰“ç‚¹ISKå‘—~ 

`EVE_ID: Alero AraragiEro`

